# Jump Analysis Toolset

This toolset consists of two scripts:
1. `jump_analysis.py` - Analyzes jump performance from videos
2. `combine_csvs.py` - Combines analysis results into a single CSV file with summary statistics

## Requirements

Required packages:
```
pip install opencv-python numpy ultralytics pandas
```

Optional package for Excel output (recommended):
```
pip install openpyxl
```

## Jump Analysis Script

This script processes videos named `1.mp4`, `2.mp4`, and `3.mp4` found in any subfolder of the specified input directory. It analyzes jump performance and saves the results as CSV files in the same location as the input videos.

### Usage

```bash
python jump_analysis.py --input_dir data/template/angle [--model yolo11m-pose.pt] [--save_video] [--save_json]
```

Arguments:
- `--input_dir`: Path to the root directory containing video files (required)
- `--model`: Path to the YOLO11 Pose model file (default: yolo11m-pose.pt)
- `--save_video`: Save annotated videos (e.g., 1_annotated.mp4) alongside originals
- `--save_json`: Save raw detection results as JSON alongside originals

Example:
```bash
python jump_analysis.py --input_dir data/template/angle
```

## CSV Combination Script

This script finds all CSV files generated by the jump_analysis.py script and combines them into a single CSV file. It adds metadata columns based on the folder structure and generates summary statistics.

### Usage

```bash
python combine_csvs.py --input_dir data/template/angle [--output_file combined_results.csv] [--summary_file jump_summary.xlsx]
```

Arguments:
- `--input_dir`: Path to the root directory containing CSV files (required)
- `--output_file`: Path to save the combined CSV file (default: combined_results.csv)
- `--summary_file`: Path to save summary statistics (default: jump_summary.xlsx)

Example:
```bash
python combine_csvs.py --input_dir data/template/angle --output_file all_jumps.csv
```

### Summary Statistics

If the openpyxl package is installed, the summary statistics will be saved to an Excel file with multiple sheets:

1. **By Person** - Average jump height and other statistics per person
2. **By Jump Type** - Statistics broken down by jump type (Normal, Squat, SingleLeg)
3. **By Surface** - Statistics broken down by surface type (gravel, ground, tiles)
4. **Person & Jump Type** - Detailed statistics for each person and jump type combination
5. **Skipped Files** - List of any files that couldn't be processed with error details

If openpyxl is not available, the script will automatically fall back to saving separate CSV files for each summary table:
- `jump_summary_by_person.csv`
- `jump_summary_by_jump_type.csv`
- `jump_summary_by_surface.csv`
- `jump_summary_by_person_jump.csv`
- `jump_summary_skipped_files.csv` (if any)

## Workflow

1. Run jump_analysis.py to process all videos and generate individual CSV results
2. Run combine_csvs.py to combine all CSV files into a single analysis file and generate summary statistics
3. The combined CSV will contain columns for Person, JumpType, Surface, and Trial to identify each result
4. Review the summary statistics in the Excel file (or CSV files) for quick insights

## Folder Structure

The scripts expect a folder structure similar to:
```
angle/
├── PersonName/
│   ├── JumpType/
│   │   ├── Surface/
│   │   │   ├── 1.mp4
│   │   │   ├── 2.mp4
│   │   │   └── 3.mp4
```

For example:
```
angle/
├── Danny/
│   ├── Normal/
│   │   ├── gravel/
│   │   │   ├── 1.mp4
│   │   │   ├── 2.mp4
│   │   │   └── 3.mp4
│   │   ├── ground/
│   │   └── tiles/
│   ├── SingleLeg/
│   └── Squat/
├── Selim/
├── Sophie/
└── ...
``` 